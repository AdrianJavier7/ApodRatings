{% extends 'base.html.twig' %}

{% block title %}Clasificación: {{ categoria.nombre }}{% endblock %}

{% block body %}
    <div class="uk-section uk-light" style="background: radial-gradient(circle at center, #1a1a2e 0%, #0f0f1b 100%); min-height: 100vh;">
        <div class="uk-container uk-container-small">

            {% if ya_rankeado %}
                <div class="uk-text-center uk-margin-large-top">
                    <div class="uk-card uk-card-secondary uk-card-body uk-border-rounded" style="border: 1px solid #1e87f0; background: rgba(15, 15, 27, 0.8);">
                        <span uk-icon="icon: lock; ratio: 3" class="uk-text-primary"></span>
                        <h2 class="uk-text-bold uk-margin-small-top">Sector Clasificado</h2>
                        <p class="uk-text-lead">Has completado el ranking de esta categoría</p>

                        <div class="uk-margin-medium-top">
                            <a href="{{ path('app_categoria') }}" class="uk-button uk-button-default uk-border-rounded">
                                <span uk-icon="arrow-left"></span> Volver a Sectores
                            </a>
                        </div>
                        <div class="uk-margin-medium-top">
                            <a href="{{ path('app_mis_rankings') }}" class="uk-button uk-button-default uk-border-rounded">
                                <span uk-icon="arrow-right"></span> Ver mi ranking
                            </a>
                        </div>
                    </div>
                </div>
            {% else %}
                <div class="uk-margin-large-bottom">
                    <a href="{{ path('app_categoria') }}" class="uk-button uk-button-text">
                        <span uk-icon="arrow-left"></span> Cancelar
                    </a>
                    <h1 class="uk-text-bold uk-margin-small-top">Clasificar: {{ categoria.nombre }}</h1>
                </div>

                <form method="POST">
                    <div class="uk-grid-small uk-child-width-1-1" uk-grid>
                        {% for foto in categoria.fotoAstrals %}
                            <div>
                                <div class="uk-card uk-card-default uk-grid-collapse uk-child-width-1-2@s uk-overflow-hidden" uk-grid
                                     style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px;">

                                    <div class="uk-card-media-left uk-cover-container" style="height: 100px; width: 150px;">
                                        <img src="{{ foto.url }}" alt="{{ foto.title }}" uk-cover>
                                    </div>

                                    <div class="uk-flex uk-flex-middle uk-flex-between uk-padding-small uk-width-expand">
                                        <div>
                                            <h4 class="uk-margin-remove uk-text-bold uk-text-truncate" style="max-width: 250px;">{{ foto.title }}</h4>
                                        </div>

                                        <div class="uk-flex uk-flex-middle">
                                            <input class="uk-input uk-form-width-xsmall uk-border-rounded"
                                                   type="number"
                                                   name="posiciones[{{ foto.id }}]"
                                                   value="{{ posiciones_guardadas[foto.id] ?? '' }}"
                                                   min="1"
                                                   max="{{ categoria.fotoAstrals|length }}"
                                                   style="background: #1e87f0; color: #fff; border: none; text-align: center;">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>

                    <div class="uk-margin-large-top uk-text-center">
                        <button type="submit" class="uk-button uk-button-primary uk-button-large uk-border-rounded"
                                style="background: linear-gradient(90deg, #1e87f0, #7021ff); border: none; padding: 0 60px;">
                            Finalizar Ranking
                        </button>
                    </div>
                </form>
            {% endif %}

        </div>
    </div>
{% endblock %}
