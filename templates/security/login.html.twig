{% extends 'base.html.twig' %}
{% block navbar %}{% endblock %}

{% block title %}Entrar{% endblock %}

{% block body %}
    <div class="uk-section uk-flex uk-flex-middle"
         uk-height-viewport
         style="background: radial-gradient(circle at center, #1a1a2e 0%, #0f0f1b 100%);">

        <div class="uk-container">
            <div class="uk-width-large uk-margin-auto">

                <div class="uk-card uk-card-body uk-border-rounded uk-light" style="border: 1px solid rgba(255,255,255,0.2);">

                    <div class="uk-text-center uk-margin-medium-bottom">
                        <h2 class="uk-h3 uk-text-bold uk-margin-remove">Entrar</h2>
                        <p class="uk-text-meta" style="color: #a0a0a0;">Navega el universo.</p>
                    </div>

                    <form method="post">
                        {# Manejo de errores de autenticación de Symfony #}
                        {% if error %}
                            <div class="uk-alert-danger uk-margin-small" uk-alert>
                                <p>{{ error.messageKey|trans(error.messageData, 'security') }}</p>
                            </div>
                        {% endif %}

                        {# Si el usuario ya está logueado #}
                        {% if app.user %}
                            <div class="uk-margin uk-text-center uk-text-small">
                                Ya estás como {{ app.user.userIdentifier }}, <a href="{{ logout_path() }}" class="uk-link-text uk-text-primary">Salir</a>
                            </div>
                        {% endif %}

                        <div class="uk-margin">
                            <div class="uk-inline uk-width-1-1">
                                <span class="uk-form-icon" uk-icon="icon: mail" style="color: #1e87f0;"></span>
                                <input class="uk-input uk-border-rounded"
                                       type="email"
                                       value="{{ last_username }}" {# Importante para recordar el último correo fallido #}
                                       name="_username"           {# Symfony busca este nombre por defecto #}
                                       id="username"
                                       placeholder="Email"
                                       style="background: rgba(0,0,0,0.2); border-color: rgba(255,255,255,0.1); color: #fff;"
                                       autocomplete="email" required autofocus>
                            </div>
                        </div>

                        <div class="uk-margin">
                            <div class="uk-inline uk-width-1-1">
                                <span class="uk-form-icon" uk-icon="icon: lock" style="color: #1e87f0;"></span>
                                <input class="uk-input uk-border-rounded"
                                       type="password"
                                       name="_password"           {# Symfony busca este nombre por defecto #}
                                       id="password"
                                       placeholder="Contraseña"
                                       style="background: rgba(0,0,0,0.2); border-color: rgba(255,255,255,0.1); color: #fff;"
                                       autocomplete="current-password" required>
                            </div>
                        </div>

                        {# Token CSRF de seguridad: Obligatorio #}
                        <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

                        <div class="uk-margin-medium-top">
                            <button class="uk-button uk-button-primary uk-width-1-1 uk-border-rounded uk-text-bold"
                                    style="box-shadow: 0 5px 15px rgba(30, 135, 240, 0.3);"
                                    type="submit">
                                DESPEGAR
                            </button>
                        </div>

                        <div class="uk-text-center uk-margin-top">
                            <a href="/registro" class="uk-text-small uk-link-reset" style="color: #888;">
                                ¿No tienes cuenta? <span style="color: #1e87f0;">Registro</span>
                            </a>
                        </div>
                    </form>

                </div>

                <p class="uk-text-center uk-text-small uk-margin-top" style="color: rgba(255,255,255,0.2); letter-spacing: 2px;">
                    EST. 2026 • NASA API
                </p>

            </div>
        </div>
    </div>
{% endblock %}
